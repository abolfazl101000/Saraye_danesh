<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مدرسه هوشمند سرای دانش - رشت</title>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <style>
        :root {
            /* پالت رنگی حرفه‌ای تر */
            --primary-color: #2563eb; /* آبی مدرن */
            --primary-dark: #1e40af;
            --secondary-color: #1e293b; /* رنگ متن تیره */
            --bg-light: #f8fafc; /* پس زمینه خیلی روشن */
            --white: #ffffff;
            --glass-bg: rgba(255, 255, 255, 0.80);
            --glass-border: rgba(255, 255, 255, 0.4);
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            --header-height: 80px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Vazirmatn', sans-serif;
        }
        
        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg-light);
            color: var(--secondary-color);
            overflow-x: hidden;
            line-height: 1.7;
        }

        /* --- Header & Nav --- */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            height: var(--header-height);
            padding: 0 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            background: transparent; /* پیش فرض شفاف */
            transition: all 0.4s ease;
        }

        /* کلاسی که وقتی اسکرول میشه به هدر اضافه میشه */
        header.scrolled {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-sm);
        }
        header.scrolled .logo { color: var(--primary-dark); text-shadow: none; }
        header.scrolled .line { background: var(--primary-dark); }


        .logo {
            font-weight: 900;
            font-size: 1.8rem;
            color: var(--white);
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
            transition: 0.4s;
        }

        .hamburger { cursor: pointer; z-index: 1001; }
        .line {
            width: 35px; height: 3px; background-color: var(--white);
            margin: 7px 0; border-radius: 5px; transition: 0.4s;
        }

        .nav-menu {
            position: fixed; top: 0; right: -100%; width: 320px; height: 100vh;
            background: var(--white); box-shadow: -10px 0 30px rgba(0,0,0,0.1);
            display: flex; flex-direction: column; padding-top: 100px; z-index: 999;
            transition: 0.5s cubic-bezier(0.77, 0.2, 0.05, 1.0);
        }
        .nav-menu.active { right: 0; }
        .nav-item {
            padding: 20px 40px; text-decoration: none; color: var(--secondary-color);
            font-size: 1.2rem; font-weight: 600; transition: 0.3s; display: flex; align-items: center;
        }
        .nav-item i { margin-left: 15px; font-size: 1.1rem; color: var(--primary-color); }
        .nav-item:hover { background: var(--bg-light); color: var(--primary-color); padding-right: 50px; }

        /* --- Hero Section --- */
        .hero {
            position: relative;
            height: 95vh; /* ارتفاع بیشتر */
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            /* گرادینت حرفه ای تر */
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
        }
        
        /* ذرات متحرک پس زمینه */
        .hero::before {
            content: ''; position: absolute; width: 200%; height: 200%; top: -50%; left: -50%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 10%, transparent 20%);
            background-size: 30px 30px; animation: moveBackground 20s linear infinite;
        }
        @keyframes moveBackground { 0% { transform: translate(0, 0); } 100% { transform: translate(100px, 100px); } }

        .hero-content {
            background: var(--glass-bg);
            padding: 60px 40px;
            border-radius: 30px;
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 2px solid var(--glass-border);
            max-width: 900px;
            width: 90%;
            z-index: 10;
            transform: translateY(30px); opacity: 0; animation: slideUp 1s ease forwards 0.5s;
        }
        @keyframes slideUp { to { transform: translateY(0); opacity: 1; } }

        .hero h1 {
            color: var(--primary-dark);
            margin-bottom: 25px;
            font-size: 3.5rem; /* فونت بسیار بزرگتر و زیباتر */
            font-weight: 900;
            letter-spacing: -1px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .hero p { color: #475569; font-size: 1.3rem; font-weight: 500; }

        /* --- Main Content --- */
        /* رفع مشکل دیده نشدن تیترها زیر هدر */
        section { scroll-margin-top: var(--header-height); }

        .container { padding: 80px 5%; max-width: 1300px; margin: 0 auto; }
        .hidden { display: none !important; }

        h2.section-title {
            text-align: center; font-size: 2.5rem; color: var(--secondary-color);
            margin-bottom: 60px; font-weight: 800; position: relative;
        }
        h2.section-title::after {
            content: ''; display: block; width: 80px; height: 6px; background: var(--primary-color);
            margin: 20px auto 0; border-radius: 10px;
        }

        /* کارت های متنی شیک */
        .content-card {
            background: var(--white); padding: 50px; border-radius: 25px;
            box-shadow: var(--shadow-lg); border: 1px solid #e2e8f0;
            font-size: 1.15rem; color: #334155;
        }

        /* --- Gallery Grid --- */
        .gallery-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 30px;
        }
        .gallery-item {
            border-radius: 20px; overflow: hidden; box-shadow: var(--shadow-sm); cursor: pointer;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .gallery-item:hover { transform: translateY(-10px) scale(1.02); box-shadow: var(--shadow-lg); }
        .gallery-item img { width: 100%; height: 300px; object-fit: cover; display: block; }

        /* --- Footer --- */
        footer {
            background: linear-gradient(to right, #0f2027, #203a43, #2c5364); /* گرادینت تیره لوکس */
            color: rgba(255,255,255,0.8); padding: 80px 5% 40px; margin-top: 100px;
        }
        .footer-content {
            display: flex; flex-wrap: wrap; justify-content: space-between; max-width: 1200px; margin: 0 auto;
        }
        .footer-section { flex: 1 1 300px; margin-bottom: 40px; padding: 0 20px; }
        .footer-section h3 { color: var(--white); margin-bottom: 25px; font-size: 1.5rem; display: flex; align-items: center; }
        .footer-section h3 i { margin-left: 10px; color: var(--primary-color); }
        .contact-list li { list-style: none; margin-bottom: 18px; display: flex; align-items: center; font-size: 1.1rem; }
        .contact-list li i { margin-left: 15px; font-size: 1.3rem; color: var(--primary-color); width: 25px; text-align: center; }

        /* --- Admin Panel Style --- */
        .modal {
            display: none; position: fixed; top: 0; right: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
            justify-content: center; align-items: center; z-index: 2000;
        }
        .modal-content {
            background: var(--white); padding: 40px; border-radius: 20px;
            text-align: center; width: 90%; max-width: 400px; box-shadow: var(--shadow-lg);
        }
        .admin-input {
            width: 100%; padding: 15px; margin: 15px 0; border: 2px solid #e2e8f0;
            border-radius: 12px; font-size: 1rem; transition: 0.3s;
        }
        .admin-input:focus { border-color: var(--primary-color); outline: none; }
        textarea.admin-input { min-height: 150px; resize: vertical; }

        .btn {
            padding: 15px 30px; background: var(--primary-color); color: white;
            border: none; border-radius: 12px; cursor: pointer; font-size: 1.1rem; font-weight: bold;
            transition: 0.3s; display: inline-flex; align-items: center; justify-content: center;
        }
        .btn i { margin-left: 10px; }
        .btn:hover { background: var(--primary-dark); transform: translateY(-3px); box-shadow: 0 10px 20px -10px rgba(37, 99, 235, 0.5); }
        .btn-secondary { background: #94a3b8; }
        .btn-secondary:hover { background: #64748b; box-shadow: 0 10px 20px -10px rgba(148, 163, 184, 0.5); }

        /* استایل مخصوص آپلود فایل */
        .file-upload-wrapper {
            border: 3px dashed #cbd5e1; border-radius: 15px; padding: 30px;
            text-align: center; cursor: pointer; transition: 0.3s; background: #f1f5f9;
            margin-bottom: 20px;
        }
        .file-upload-wrapper:hover { border-color: var(--primary-color); background: #e0f2fe; }
        .file-upload-wrapper i { font-size: 3rem; color: var(--primary-color); margin-bottom: 15px; }
        #gallery-preview-admin {
            display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px;
        }
        .admin-preview-img {
            width: 80px; height: 80px; object-fit: cover; border-radius: 10px; border: 2px solid var(--primary-color);
        }

        .toast {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px);
            background: #10b981; color: white; padding: 15px 40px; border-radius: 50px;
            display: flex; align-items: center; box-shadow: var(--shadow-lg); z-index: 3000;
            font-weight: bold; opacity: 0; transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .toast i { margin-left: 15px; font-size: 1.4rem; background: rgba(255,255,255,0.2); padding: 5px; border-radius: 50%; }

    </style>
</head>
<body>

    <header>
        <div class="logo">مدرسه سرای دانش</div>
        <div class="hamburger" onclick="toggleMenu()">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </div>
    </header>

    <nav class="nav-menu" id="navMenu">
        <a class="nav-item" onclick="navigate('home')"><i class="fas fa-home"></i> صفحه اصلی</a>
        <a class="nav-item" onclick="navigate('about')"><i class="fas fa-info-circle"></i> درباره ما</a>
        <a class="nav-item" onclick="navigate('gallery-page')"><i class="fas fa-images"></i> گالری تصاویر</a>
        <a class="nav-item" onclick="navigate('contact-page')"><i class="fas fa-phone-alt"></i> ارتباط با ما</a>
        <a class="nav-item" onclick="openCodeModal()"><i class="fas fa-lock"></i> کد ویژه مدیر</a>
        <a class="nav-item hidden" id="adminLink" onclick="navigate('admin')" style="background: #e0f2fe; color: var(--primary-dark);"><i class="fas fa-cogs"></i> پنل مدیریت</a>
    </nav>

    <section id="home" class="page-section">
        <div class="hero">
            <div class="hero-content">
                <h1 id="view-school-name">مدرسه هوشمند سرای دانش</h1>
                <p id="view-hero-desc">جایی که آینده فرزندان شما با دانش و تکنولوژی روز رقم می‌خورد.</p>
            </div>
        </div>

        <div class="container">
            <h2 class="section-title">چرا سرای دانش؟</h2>
            <div class="content-card">
                <p id="view-home-extra-text" style="text-align: justify;">
                    آموزش در دنیای امروز فراتر از کتاب‌های درسی است. ما در سرای دانش معتقدیم که مدرسه باید محیطی برای کشف استعدادها، یادگیری مهارت‌های زندگی و استفاده از تکنولوژی‌های نوین باشد. این مدرسه با فراهم آوردن امکانات هوشمند، آزمایشگاه‌های مجهز و کادر آموزشی مجرب، بستری را فراهم کرده تا دانش‌آموزان نه تنها در درس، بلکه در تمام ابعاد زندگی موفق باشند. (این متن نمونه است و توسط مدیر قابل تغییر می‌باشد)
                </p>
            </div>
        </div>

        <footer>
            <div class="footer-content">
                <div class="footer-section">
                    <h3><i class="fas fa-map-marker-alt"></i> راه‌های ارتباطی</h3>
                    <ul class="contact-list">
                        <li><i class="fas fa-location-arrow"></i> <span id="view-footer-address">رشت، گلسار، بلوار دیلمان</span></li>
                        <li><i class="fas fa-phone"></i> <span id="view-footer-phone">013-33770000</span></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3><i class="fas fa-hashtag"></i> شبکه‌های اجتماعی</h3>
                    <ul class="contact-list">
                        <li><i class="fab fa-instagram"></i> <span id="view-footer-insta">@saraye.danesh.rasht</span></li>
                        <li><i class="fab fa-telegram-plane"></i> <span id="view-footer-telegram">@sarayedanesh_channel</span></li>
                        <li><i class="fab fa-whatsapp"></i> <span id="view-footer-whatsapp">09119876543</span></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3><i class="fas fa-clock"></i> ساعات کاری</h3>
                    <ul class="contact-list" style="opacity: 0.8;">
                        <li>شنبه تا چهارشنبه: ۷:۳۰ الی ۱۴:۳۰</li>
                        <li>پنجشنبه: ۷:۳۰ الی ۱۲:۳۰</li>
                    </ul>
                </div>
            </div>
            <div style="text-align: center; margin-top: 40px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; font-size: 0.9rem;">
                تمامی حقوق برای مدرسه سرای دانش محفوظ است © ۱۴۰۲
            </div>
        </footer>
    </section>

    <section id="about" class="page-section hidden">
        <div class="container" style="padding-top: 120px;">
            <h2 class="section-title">درباره ما بیشتر بدانید</h2>
            <div class="content-card" style="display: flex; gap: 40px; align-items: center;">
                <div style="flex: 2;">
                     <p id="view-about-text" style="text-align: justify; margin-bottom: 20px;">
                        مدرسه سرای دانش در سال ۱۳۸۵ با هدف ایجاد تحولی نوین در سیستم آموزشی شهر باران‌های نقره‌ای، رشت، تاسیس شد. موسس این مجموعه، جناب آقای دکتر علیرضا محمدی، با سابقه‌ای درخشان در حوزه آموزش و پرورش، بر این باورند که یادگیری باید همراه با شادی، خلاقیت و استفاده از ابزارهای روز دنیا باشد. ما مفتخریم که در طول این سال‌ها، صدها دانش‌آموز موفق را به جامعه تحویل داده‌ایم.
                    </p>
                    <p style="font-weight: bold; color: var(--primary-color);">ماموریت ما: پرورش نسلی خلاق، متفکر و مسئولیت‌پذیر.</p>
                </div>
                <div style="flex: 1; display: none; @media (min-width: 768px) { display: block; }">
                    <img src="https://img.freepik.com/free-vector/back-school-concept-with-building_23-2147863759.jpg?w=740&t=st=1700000000~exp=1700000600~hmac=e5a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4" alt="درباره مدرسه" style="width: 100%; border-radius: 20px;">
                </div>
            </div>
        </div>
    </section>

    <section id="gallery-page" class="page-section hidden">
        <div class="container" style="padding-top: 120px;">
            <h2 class="section-title">گالری تصاویر و رویدادها</h2>
            <div class="gallery-grid" id="view-full-gallery">
                </div>
        </div>
    </section>

    <section id="contact-page" class="page-section hidden">
        <div class="container" style="padding-top: 120px;">
            <h2 class="section-title">با ما در ارتباط باشید</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;">
                <div class="content-card" style="text-align: center;">
                    <i class="fas fa-map-marked-alt" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 20px;"></i>
                    <h3>آدرس ما</h3>
                    <p id="view-contact-address" style="margin-top: 15px;">رشت، گلسار، بلوار دیلمان</p>
                </div>
                 <div class="content-card" style="text-align: center;">
                    <i class="fas fa-headset" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 20px;"></i>
                    <h3>تلفن‌های تماس</h3>
                    <p id="view-contact-phone" style="margin-top: 15px; direction: ltr;">013-33770000</p>
                </div>
                 <div class="content-card" style="text-align: center;">
                    <i class="fas fa-share-alt" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 20px;"></i>
                    <h3>فضای مجازی</h3>
                    <p style="margin-top: 15px;">اینستاگرام: <span id="view-contact-insta">@saraye.danesh</span></p>
                </div>
            </div>
        </div>
    </section>

    <section id="admin" class="page-section hidden">
        <div class="container" style="padding-top: 120px;">
            <h2 class="section-title"><i class="fas fa-user-cog"></i> پنل مدیریت وب‌سایت</h2>
            
            <div class="content-card" style="margin-bottom: 40px;">
                <h3 style="color: var(--primary-dark); margin-bottom: 25px; display: flex; align-items: center;"><i class="fas fa-home" style="margin-left: 10px;"></i> تنظیمات صفحه اصلی</h3>
                <label class="admin-label">عنوان اصلی مدرسه (در هدر):</label>
                <input type="text" id="admin-school-name" class="admin-input">
                
                <label class="admin-label">متن کوتاه زیر عنوان (Hero Section):</label>
                <textarea id="admin-hero-desc" class="admin-input" style="min-height: 100px;"></textarea>
                
                <label class="admin-label">متن توضیحات تکمیلی صفحه اصلی (چرا سرای دانش؟):</label>
                <textarea id="admin-home-extra" class="admin-input"></textarea>
                
                <button class="btn" onclick="saveData('home')"><i class="fas fa-save"></i> ذخیره تغییرات اصلی</button>
            </div>

            <div class="content-card" style="margin-bottom: 40px;">
                <h3 style="color: var(--primary-dark); margin-bottom: 25px; display: flex; align-items: center;"><i class="fas fa-info-circle" style="margin-left: 10px;"></i> تنظیمات بخش درباره ما</h3>
                <label class="admin-label">متن کامل صفحه درباره ما:</label>
                <textarea id="admin-about-text" class="admin-input"></textarea>
                <button class="btn" onclick="saveData('about')"><i class="fas fa-save"></i> ذخیره متن درباره ما</button>
            </div>

            <div class="content-card" style="margin-bottom: 40px;">
                <h3 style="color: var(--primary-dark); margin-bottom: 25px; display: flex; align-items: center;"><i class="fas fa-address-book" style="margin-left: 10px;"></i> اطلاعات تماس و فوتر</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div><label>آدرس:</label><input type="text" id="admin-address" class="admin-input"></div>
                    <div><label>تلفن:</label><input type="text" id="admin-phone" class="admin-input"></div>
                    <div><label>اینستاگرام:</label><input type="text" id="admin-insta" class="admin-input"></div>
                    <div><label>تلگرام:</label><input type="text" id="admin-telegram" class="admin-input"></div>
                    <div><label>واتساپ:</label><input type="text" id="admin-whatsapp" class="admin-input"></div>
                </div>
                <button class="btn" onclick="saveData('contact')"><i class="fas fa-save"></i> ذخیره اطلاعات تماس</button>
            </div>

            <div class="content-card">
                <h3 style="color: var(--primary-dark); margin-bottom: 25px; display: flex; align-items: center;"><i class="fas fa-images" style="margin-left: 10px;"></i> مدیریت گالری تصاویر</h3>
                <p style="margin-bottom: 20px; font-size: 0.9rem; color: #666;">تصاویر جدید را انتخاب کنید. (تصاویر قبلی حفظ می‌شوند)</p>
                
                <label for="gallery-upload" class="file-upload-wrapper">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p style="font-weight: bold;">برای انتخاب تصاویر کلیک کنید</p>
                    <p style="font-size: 0.9rem; color: #666;">(پشتیبانی از انتخاب چند فایل همزمان)</p>
                </label>
                <input type="file" id="gallery-upload" multiple accept="image/*" style="display: none;" onchange="handleImageUpload(this)">

                <div id="gallery-preview-admin"></div>
            </div>

        </div>
    </section>

    <div id="codeModal" class="modal">
        <div class="modal-content">
            <i class="fas fa-user-shield" style="font-size: 3rem; color: var(--primary-color); margin-bottom: 20px;"></i>
            <h3>احراز هویت مدیر</h3>
            <p style="margin: 15px 0; color: #666;">لطفا کد امنیتی را وارد نمایید:</p>
            <input type="password" id="secretCode" class="admin-input" placeholder="کد ورود...">
            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
                <button class="btn" onclick="checkCode()">ورود به پنل</button>
                <button class="btn btn-secondary" onclick="closeModal()">انصراف</button>
            </div>
        </div>
    </div>

    <div id="toast" class="toast">
        <i class="fas fa-check"></i> تغییرات با موفقیت اعمال شد!
    </div>

    <script>
        // --- داده‌های اولیه سایت ---
        let siteData = {
            schoolName: "مدرسه هوشمند سرای دانش",
            heroDesc: "جایی که آینده فرزندان شما با دانش و تکنولوژی روز رقم می‌خورد.",
            homeExtraText: "آموزش در دنیای امروز فراتر از کتاب‌های درسی است. ما در سرای دانش معتقدیم که مدرسه باید محیطی برای کشف استعدادها، یادگیری مهارت‌های زندگی و استفاده از تکنولوژی‌های نوین باشد. این مدرسه با فراهم آوردن امکانات هوشمند، آزمایشگاه‌های مجهز و کادر آموزشی مجرب، بستری را فراهم کرده تا دانش‌آموزان نه تنها در درس، بلکه در تمام ابعاد زندگی موفق باشند.",
            aboutText: "مدرسه سرای دانش در سال ۱۳۸۵ با هدف ایجاد تحولی نوین در سیستم آموزشی شهر باران‌های نقره‌ای، رشت، تاسیس شد. موسس این مجموعه، جناب آقای دکتر علیرضا محمدی، با سابقه‌ای درخشان در حوزه آموزش و پرورش، بر این باورند که یادگیری باید همراه با شادی، خلاقیت و استفاده از ابزارهای روز دنیا باشد. ما مفتخریم که در طول این سال‌ها، صدها دانش‌آموز موفق را به جامعه تحویل داده‌ایم.",
            address: "رشت، گلسار، بلوار دیلمان، کوچه بوستان",
            phone: "013-33770000",
            insta: "@saraye.danesh.rasht",
            telegram: "@sarayedanesh_channel",
            whatsapp: "09119876543",
            // تصاویر پیشفرض (لینک مستقیم برای شروع)
            gallery: [
                "https://img.freepik.com/free-photo/modern-school-building_1150-14947.jpg?w=826&t=st=1700001000~exp=1700001600~hmac=a1a1a1",
                "https://img.freepik.com/free-photo/group-diverse-grads-throwing-caps-up-sky_53876-56031.jpg?w=826&t=st=1700001000~exp=1700001600~hmac=b2b2b2",
                "https://img.freepik.com/free-photo/happy-teacher-with-students-class_1098-20943.jpg?w=826&t=st=1700001000~exp=1700001600~hmac=c3c3c3",
                "https://img.freepik.com/free-photo/library-with-bookshelves-ladders_1098-18351.jpg?w=826&t=st=1700001000~exp=1700001600~hmac=d4d4d4"
            ]
        };

        // --- توابع UI و تعاملی ---

        // تغییر استایل هدر هنگام اسکرول
        window.addEventListener('scroll', function() {
            const header = document.querySelector('header');
            const lines = document.querySelectorAll('.line');
            const logo = document.querySelector('.logo');
            
            // اگر بیش از 50 پیکسل اسکرول شد یا در صفحه‌ای غیر از خانه هستیم
            if (window.scrollY > 50 || !document.getElementById('home').classList.contains('hidden') === false ) {
                header.classList.add('scrolled');
            } else {
                // فقط در صفحه اصلی و وقتی بالا هستیم هدر شفاف شود
                if (!document.getElementById('home').classList.contains('hidden')) {
                    header.classList.remove('scrolled');
                }
            }
        });

        function toggleMenu() {
            document.getElementById('navMenu').classList.toggle('active');
        }

        function navigate(pageId) {
            document.querySelectorAll('.page-section').forEach(sec => sec.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
            document.getElementById('navMenu').classList.remove('active');
            window.scrollTo(0,0);

            // تریگر کردن رویداد اسکرول برای تنظیم سریع هدر
            window.dispatchEvent(new Event('scroll'));
        }

        // --- بخش کد ویژه و ادمین ---
        function openCodeModal() {
            document.getElementById('codeModal').style.flex = 'flex';
            document.getElementById('codeModal').style.display = 'flex';
            toggleMenu();
        }
        function closeModal() {
            document.getElementById('codeModal').style.display = 'none';
        }
        function checkCode() {
            if(document.getElementById('secretCode').value === "admin1234") {
                document.getElementById('adminLink').classList.remove('hidden');
                closeModal();
                showToast('<i class="fas fa-unlock"></i> پنل مدیریت فعال شد!');
                navigate('admin');
                loadAdminValues();
            } else {
                alert("کد اشتباه است!");
            }
        }

        // --- مدیریت داده‌ها و رندرینگ ---
        function renderSite() {
            // متون
            document.getElementById('view-school-name').innerText = siteData.schoolName;
            document.getElementById('view-hero-desc').innerText = siteData.heroDesc;
            document.getElementById('view-home-extra-text').innerText = siteData.homeExtraText;
            document.getElementById('view-about-text').innerText = siteData.aboutText;
            
            // تماس
            document.getElementById('view-footer-address').innerText = siteData.address;
            document.getElementById('view-contact-address').innerText = siteData.address;
            document.getElementById('view-footer-phone').innerText = siteData.phone;
            document.getElementById('view-contact-phone').innerText = siteData.phone;
            document.getElementById('view-footer-insta').innerText = siteData.insta;
            document.getElementById('view-contact-insta').innerText = siteData.insta;
            document.getElementById('view-footer-telegram').innerText = siteData.telegram;
            document.getElementById('view-footer-whatsapp').innerText = siteData.whatsapp;

            // گالری (فقط در صفحه گالری)
            const galleryHTML = siteData.gallery.map(src => 
                `<div class="gallery-item"><img src="${src}" alt="تصویر مدرسه"></div>`
            ).join('');
            document.getElementById('view-full-gallery').innerHTML = galleryHTML;
        }

        function loadAdminValues() {
            document.getElementById('admin-school-name').value = siteData.schoolName;
            document.getElementById('admin-hero-desc').value = siteData.heroDesc;
            document.getElementById('admin-home-extra').value = siteData.homeExtraText;
            document.getElementById('admin-about-text').value = siteData.aboutText;
            document.getElementById('admin-address').value = siteData.address;
            document.getElementById('admin-phone').value = siteData.phone;
            document.getElementById('admin-insta').value = siteData.insta;
            document.getElementById('admin-telegram').value = siteData.telegram;
            document.getElementById('admin-whatsapp').value = siteData.whatsapp;
        }

        function saveData(section) {
            if (section === 'home') {
                siteData.schoolName = document.getElementById('admin-school-name').value;
                siteData.heroDesc = document.getElementById('admin-hero-desc').value;
                siteData.homeExtraText = document.getElementById('admin-home-extra').value;
            } else if (section === 'about') {
                siteData.aboutText = document.getElementById('admin-about-text').value;
            } else if (section === 'contact') {
                siteData.address = document.getElementById('admin-address').value;
                siteData.phone = document.getElementById('admin-phone').value;
                siteData.insta = document.getElementById('admin-insta').value;
                siteData.telegram = document.getElementById('admin-telegram').value;
                siteData.whatsapp = document.getElementById('admin-whatsapp').value;
            }
            renderSite();
            showToast();
        }

        // --- تابع جدید و حرفه‌ای برای آپلود تصویر ---
        function handleImageUpload(input) {
            const files = input.files;
            if (files.length === 0) return;

            // نمایش لودینگ (اختیاری)
            const previewContainer = document.getElementById('gallery-preview-admin');
            previewContainer.innerHTML = '<p style="color: var(--primary-color);">در حال پردازش تصاویر...</p>';

            // پردازش فایل‌ها
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // اضافه کردن تصویر جدید به ابتدای آرایه گالری
                    siteData.gallery.unshift(e.target.result);
                    
                    // رندر مجدد سایت برای نمایش تصویر جدید در گالری اصلی
                    renderSite();

                     // نمایش پیش‌نمایش کوچک در پنل ادمین
                    const imgPreview = document.createElement('img');
                    imgPreview.src = e.target.result;
                    imgPreview.classList.add('admin-preview-img');
                    previewContainer.appendChild(imgPreview);
                };
                // خواندن فایل به صورت Data URL (مناسب برای نمایش بدون سرور)
                reader.readAsDataURL(file);
            });
             // پاک کردن پیام لودینگ بعد از شروع پردازش
             setTimeout(() => {
                 if(previewContainer.querySelector('p')) previewContainer.querySelector('p').remove();
                  showToast('<i class="fas fa-images"></i> تصاویر به گالری اضافه شدند!');
             }, 1000);

            // ریست کردن اینپوت برای امکان انتخاب مجدد همان فایل‌ها
            input.value = '';
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            if(msg) toast.innerHTML = msg;
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        // اجرای اولیه
        renderSite();
        // تریگر اولیه برای تنظیم هدر
        window.dispatchEvent(new Event('scroll'));
    </script>
</body>
</html>